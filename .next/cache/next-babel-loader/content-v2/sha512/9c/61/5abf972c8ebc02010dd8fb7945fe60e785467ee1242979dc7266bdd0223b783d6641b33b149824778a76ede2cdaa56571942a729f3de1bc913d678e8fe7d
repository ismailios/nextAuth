{"ast":null,"code":"import { connectToDB } from \"../../../lib/db\";\nimport { hachPassword } from \"../../../lib/auth\";\n\nconst handler = async (req, res) => {\n  if (req.method === \"POST\") {\n    try {\n      const data = req.body;\n      const {\n        email,\n        password\n      } = data;\n\n      if (!email || !email.includes(\"@\") || !password || password.trim().length < 7) {\n        res.status(420).json({\n          message: \"Inputs  not valid\"\n        });\n        return;\n      }\n\n      const client = await connectToDB();\n      const db = client.db();\n      const existingUser = db.collection(\"users\").findOne({\n        email: email\n      });\n\n      if (existingUser) {\n        res.status(422).json({\n          message: \"user Already Exist !!\"\n        });\n        client.close();\n        return;\n      }\n\n      const hachedPassword = await hachPassword(password);\n      const result = await db.collection(\"users\").insertOne({\n        email: email,\n        password: hachedPassword\n      });\n      res.status(201).json({\n        message: \"User Created Successefully !!\"\n      });\n      client.close();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n};\n\nexport default handler;","map":{"version":3,"sources":["/Users/user/Downloads/nextjs-course-code-12-auth-extra-files/starting-project/pages/api/auth/signup.js"],"names":["connectToDB","hachPassword","handler","req","res","method","data","body","email","password","includes","trim","length","status","json","message","client","db","existingUser","collection","findOne","close","hachedPassword","result","insertOne","error","console","log"],"mappings":"AAAA,SAASA,WAAT,QAA4B,iBAA5B;AACA,SAASC,YAAT,QAA6B,mBAA7B;;AAEA,MAAMC,OAAO,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAClC,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,QAAI;AACF,YAAMC,IAAI,GAAGH,GAAG,CAACI,IAAjB;AAEA,YAAM;AAAEC,QAAAA,KAAF;AAASC,QAAAA;AAAT,UAAsBH,IAA5B;;AAEA,UACE,CAACE,KAAD,IACA,CAACA,KAAK,CAACE,QAAN,CAAe,GAAf,CADD,IAEA,CAACD,QAFD,IAGAA,QAAQ,CAACE,IAAT,GAAgBC,MAAhB,GAAyB,CAJ3B,EAKE;AACAR,QAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,UAAAA,OAAO,EAAE;AADU,SAArB;AAGA;AACD;;AAED,YAAMC,MAAM,GAAG,MAAMhB,WAAW,EAAhC;AACA,YAAMiB,EAAE,GAAGD,MAAM,CAACC,EAAP,EAAX;AAEA,YAAMC,YAAY,GAAGD,EAAE,CAACE,UAAH,CAAc,OAAd,EAAuBC,OAAvB,CAA+B;AAAEZ,QAAAA,KAAK,EAAEA;AAAT,OAA/B,CAArB;;AACA,UAAIU,YAAJ,EAAkB;AAChBd,QAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,UAAAA,OAAO,EAAE;AADU,SAArB;AAGAC,QAAAA,MAAM,CAACK,KAAP;AACA;AACD;;AAED,YAAMC,cAAc,GAAG,MAAMrB,YAAY,CAACQ,QAAD,CAAzC;AAEA,YAAMc,MAAM,GAAG,MAAMN,EAAE,CAACE,UAAH,CAAc,OAAd,EAAuBK,SAAvB,CAAiC;AACpDhB,QAAAA,KAAK,EAAEA,KAD6C;AAEpDC,QAAAA,QAAQ,EAAEa;AAF0C,OAAjC,CAArB;AAKAlB,MAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,QAAAA,OAAO,EAAE;AADU,OAArB;AAGAC,MAAAA,MAAM,CAACK,KAAP;AACD,KAxCD,CAwCE,OAAOI,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD;AACF;AACF,CA9CD;;AAgDA,eAAevB,OAAf","sourcesContent":["import { connectToDB } from \"../../../lib/db\";\nimport { hachPassword } from \"../../../lib/auth\";\n\nconst handler = async (req, res) => {\n  if (req.method === \"POST\") {\n    try {\n      const data = req.body;\n\n      const { email, password } = data;\n\n      if (\n        !email ||\n        !email.includes(\"@\") ||\n        !password ||\n        password.trim().length < 7\n      ) {\n        res.status(420).json({\n          message: \"Inputs  not valid\",\n        });\n        return;\n      }\n\n      const client = await connectToDB();\n      const db = client.db();\n\n      const existingUser = db.collection(\"users\").findOne({ email: email });\n      if (existingUser) {\n        res.status(422).json({\n          message: \"user Already Exist !!\",\n        });\n        client.close();\n        return;\n      }\n\n      const hachedPassword = await hachPassword(password);\n\n      const result = await db.collection(\"users\").insertOne({\n        email: email,\n        password: hachedPassword,\n      });\n\n      res.status(201).json({\n        message: \"User Created Successefully !!\",\n      });\n      client.close();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n};\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}