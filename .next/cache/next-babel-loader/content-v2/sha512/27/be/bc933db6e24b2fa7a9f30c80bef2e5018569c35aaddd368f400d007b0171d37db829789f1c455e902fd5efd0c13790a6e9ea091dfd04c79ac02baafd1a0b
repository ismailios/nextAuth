{"ast":null,"code":"import NextAuth from \"next-auth\";\nimport Providers from \"next-auth/providers\";\nimport { verifyPassword } from \"../../../lib/auth\";\nimport { connectToDB } from \"../../../lib/db\";\nexport default NextAuth({\n  session: {\n    jwt: true\n  },\n  providers: [Providers.Credentials({\n    async authorize(credentials) {\n      const client = await connectToDB();\n      const usersCollectons = client.db().collection(\"users\");\n      const user = await usersCollectons.findOne({\n        email: credentials.email\n      });\n      console.log(\"hna \" + credentials.email);\n\n      if (!user) {\n        client.close();\n        throw new Error(\"User not found !!\");\n      }\n\n      const isValid = await verifyPassword(credentials.password, user.password);\n\n      if (!isValid) {\n        client.close();\n        throw new Error(\"Could not log you !!\");\n      }\n\n      client.close();\n      return {\n        email: user.email\n      };\n    }\n\n  })]\n});","map":{"version":3,"sources":["/Users/user/Downloads/nextjs-course-code-12-auth-extra-files/starting-project/pages/api/auth/[...nextauth].js"],"names":["NextAuth","Providers","verifyPassword","connectToDB","session","jwt","providers","Credentials","authorize","credentials","client","usersCollectons","db","collection","user","findOne","email","console","log","close","Error","isValid","password"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,WAArB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;AACA,SAASC,cAAT,QAA+B,mBAA/B;AACA,SAASC,WAAT,QAA4B,iBAA5B;AAEA,eAAeH,QAAQ,CAAC;AACtBI,EAAAA,OAAO,EAAE;AACPC,IAAAA,GAAG,EAAE;AADE,GADa;AAItBC,EAAAA,SAAS,EAAE,CACTL,SAAS,CAACM,WAAV,CAAsB;AACpB,UAAMC,SAAN,CAAgBC,WAAhB,EAA6B;AAC3B,YAAMC,MAAM,GAAG,MAAMP,WAAW,EAAhC;AAEA,YAAMQ,eAAe,GAAGD,MAAM,CAACE,EAAP,GAAYC,UAAZ,CAAuB,OAAvB,CAAxB;AAEA,YAAMC,IAAI,GAAG,MAAMH,eAAe,CAACI,OAAhB,CAAwB;AACzCC,QAAAA,KAAK,EAAEP,WAAW,CAACO;AADsB,OAAxB,CAAnB;AAIAC,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAST,WAAW,CAACO,KAAjC;;AAEA,UAAI,CAACF,IAAL,EAAW;AACTJ,QAAAA,MAAM,CAACS,KAAP;AACA,cAAM,IAAIC,KAAJ,CAAU,mBAAV,CAAN;AACD;;AAED,YAAMC,OAAO,GAAG,MAAMnB,cAAc,CAClCO,WAAW,CAACa,QADsB,EAElCR,IAAI,CAACQ,QAF6B,CAApC;;AAKA,UAAI,CAACD,OAAL,EAAc;AACZX,QAAAA,MAAM,CAACS,KAAP;AACA,cAAM,IAAIC,KAAJ,CAAU,sBAAV,CAAN;AACD;;AAEDV,MAAAA,MAAM,CAACS,KAAP;AAEA,aAAO;AACLH,QAAAA,KAAK,EAAEF,IAAI,CAACE;AADP,OAAP;AAGD;;AAhCmB,GAAtB,CADS;AAJW,CAAD,CAAvB","sourcesContent":["import NextAuth from \"next-auth\";\nimport Providers from \"next-auth/providers\";\nimport { verifyPassword } from \"../../../lib/auth\";\nimport { connectToDB } from \"../../../lib/db\";\n\nexport default NextAuth({\n  session: {\n    jwt: true,\n  },\n  providers: [\n    Providers.Credentials({\n      async authorize(credentials) {\n        const client = await connectToDB();\n\n        const usersCollectons = client.db().collection(\"users\");\n\n        const user = await usersCollectons.findOne({\n          email: credentials.email,\n        });\n\n        console.log(\"hna \" + credentials.email);\n\n        if (!user) {\n          client.close();\n          throw new Error(\"User not found !!\");\n        }\n\n        const isValid = await verifyPassword(\n          credentials.password,\n          user.password\n        );\n\n        if (!isValid) {\n          client.close();\n          throw new Error(\"Could not log you !!\");\n        }\n\n        client.close();\n\n        return {\n          email: user.email,\n        };\n      },\n    }),\n  ],\n});\n"]},"metadata":{},"sourceType":"module"}